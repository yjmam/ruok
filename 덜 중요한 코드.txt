less important codes
about 300 lines